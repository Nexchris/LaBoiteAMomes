<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carousel with Text</title>
  <style>
    html,
    body {
      padding: 0;
      margin: 0;
    }

    html {
      height: 100vh;
    }

    body {
      height: 100vh;
    }

    .carousel {
      width: 100%;
      height: 100%;
      align-items: center;
      font-family: Arial;
    }

    .carousel__list {
      display: flex;
      list-style: none;
      position: relative;
      width: 100%;
      height: 300px;
      justify-content: center;
      perspective: 300px;
    }

    .carousel__item {
      display: flex;
      align-items: flex-end;
      justify-content: center;
      font-size: 0px; /* Choisir une taille de police appropriée */
      width: 570px;
      height: 780px;
      border-radius: 12px;
      box-shadow: 0px 2px 8px 0px rgba(50, 50, 50, 0.5);
      position: absolute;
      transition: all 0.3s ease-in;
    }

    .carousel__item a {
      text-decoration: none;
      color: inherit;
    }

    .carousel__item.pointer {
      cursor: pointer;
    }

    .carousel__item:nth-child(1) {
      background: url("https://images2.imgbox.com/35/3d/QNjq3E2d_o.png") no-repeat 50% / cover;
    }

    .carousel__item:nth-child(2) {
      background: url("https://images2.imgbox.com/5f/58/1v3EbDPI_o.png") no-repeat 50% / cover;
    }

    .carousel__item:nth-child(3) {
      background: url("https://images2.imgbox.com/86/4b/JWeFoovw_o.png") no-repeat 50% / cover;
    }

    .carousel__item:nth-child(4) {
      background: url("https://images2.imgbox.com/a2/fd/RbFad7TX_o.png") no-repeat 50% / cover;
    }

    .carousel__item:nth-child(5) {
      background: url("https://images2.imgbox.com/6f/c2/D9PZbC2Z_o.jpg") no-repeat 50% / cover;
    }

    .carousel__item[data-pos='0'] {
      z-index: 5;
    }

    .carousel__item[data-pos='-1'],
    .carousel__item[data-pos='1'] {
      opacity: 0.7;
      filter: blur(1px) grayscale(10%);
    }

    .carousel__item[data-pos='-1'] {
      transform: translateX(-40%) scale(0.9);
      z-index: 4;
    }

    .carousel__item[data-pos='1'] {
      transform: translateX(40%) scale(0.9);
      z-index: 4;
    }

    .carousel__item[data-pos='-2'],
    .carousel__item[data-pos='2'] {
      opacity: 0.4;
      filter: blur(3px) grayscale(20%);
    }

    .carousel__item[data-pos='-2'] {
      transform: translateX(-70%) scale(0.8);
      z-index: 3;
    }

    .carousel__item[data-pos='2'] {
      transform: translateX(70%) scale(0.8);
      z-index: 3;
    }

    .carousel__item[data-pos='0'] .carousel__text {
      display: block;
    }
  </style>
</head>
<body>
  <div class="productions-cinema">
  <div class="carousel">
    <ul class="carousel__list">
      <li class="carousel__item" data-pos="-2">
        <a href="https://www.boitamomes.fr/productions/productions-cinema/la-rixe/"><span class="carousel__text">La Rixe</span></a>
      </li>
      <li class="carousel__item" data-pos="-1">
        <a href="https://www.boitamomes.fr/productions/productions-cinema/fausse-rumeur/"><span class="carousel__text">Fausses Rumeurs</span></a>
      </li>
      <li class="carousel__item" data-pos="0">
        <a href="https://www.boitamomes.fr/productions/productions-cinema/sous-tension/"><span class="carousel__text">Sous Tension</span></a>
      </li>
      <li class="carousel__item" data-pos="1">
        <a href="https://www.boitamomes.fr/productions/productions-cinema/happy-birthday/"><span class="carousel__text">Happy Birthday</span></a>
      </li>
      <li class="carousel__item" data-pos="2">
        <a href="https://www.boitamomes.fr/productions/productions-cinema/un-jour-comme-un-autre-ou-presque/"><span class="carousel__text">Un Jour comme un autre... ou presque</span></a>
      </li>
    </ul>
  </div>
</div>

  <script>
    const state = {};
    const carouselList = document.querySelector('.carousel__list');
    const carouselItems = document.querySelectorAll('.carousel__item');
    const elems = Array.from(carouselItems);

    const updatePointerCursor = () => {
      elems.forEach(item => {
        if (item.dataset.pos == '0') {
          item.classList.add('pointer');
        } else {
          item.classList.remove('pointer');
        }
      });
    };

    carouselList.addEventListener('click', function (event) {
      var newActive = event.target.closest('.carousel__item');

      if (!newActive || newActive.classList.contains('carousel__item_active')) {
        return;
      }

      const newActivePos = newActive.dataset.pos;

      // Vérifier si le nouvel élément actif est au centre (data-pos="0")
      if (newActivePos === '0') {
        // Autoriser le lien <a> à être suivi
        const link = newActive.querySelector('a');
        if (link) {
          window.location.href = link.href;
        }
      }

      update(newActive);
      updatePointerCursor(); // Mettre à jour le curseur après avoir mis à jour les positions
    });

    const update = function (newActive) {
      const newActivePos = newActive.dataset.pos;

      const current = elems.find((elem) => elem.dataset.pos == 0);
      const prev = elems.find((elem) => elem.dataset.pos == -1);
      const next = elems.find((elem) => elem.dataset.pos == 1);
      const first = elems.find((elem) => elem.dataset.pos == -2);
      const last = elems.find((elem) => elem.dataset.pos == 2);

      current.classList.remove('carousel__item_active');

      [current, prev, next, first, last].forEach(item => {
        var itemPos = item.dataset.pos;
        item.dataset.pos = getPos(itemPos, newActivePos);
      });
    };

    const getPos = function (current, active) {
      const diff = current - active;

      if (Math.abs(current - active) > 2) {
        return -current;
      }

      return diff;
    }

    // Mettre à jour le curseur lors du chargement initial de la page
    updatePointerCursor();
  </script>
</body>
</html>
